[toc]

---
##调试

>loss: nan

learning rate is excessive, before:0.1,after:0.01

>--dataset mnist    #error

mnist is not defined, this code is suitable for cifar10 only, what we need is to append(datasets)

>python train.py --batch_size 30 --max_epochs 60 --runname train01 --wm_batch_size 2 --dataset cifar10 --lr 0.01
>>training : \
 Step: 21ms | Tot: 33s544ms | Loss: 0.043 | Acc: 99.668% (49834/50000)   
test : \
 Step: 2ms | Tot: 1s338ms | Loss: 0.398 | Acc: 93.770% (9377/10000) 

---
python train.py --batch_size 128 --max_epochs 60 --runname WMtrain02 --wm_batch_size 2 --dataset cifar10 --lr 0.01 --wmtrain 

## 成功的案例：
`python train.py --batch_size 128 --max_epochs 60 --runname WMtrain02 --wm_batch_size 2 --dataset cifar10 --lr 0.01 --wmtrain` 
train.py:107: SyntaxWarning: "is" with a literal. Did you mean "=="?
  'net': net.module if device is 'cuda' else net,
==> Preparing data..
Using CIFAR10 dataset.
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./data/cifar-10-python.tar.gz
170499072it [14:08, 200873.83it/s]                                                                                                                              
Extracting ./data/cifar-10-python.tar.gz to ./data
Files already downloaded and verified
Loading watermark images
==> Building model..
>Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 297ms | Loss: 2.302 | Acc: 12.000% (12/100)                              

>Epoch: 0
 [=========================== 391/391 ============================>]  Step: 211ms | Tot: 12s630ms | Loss: 1.442 | Acc: 47.452% (24097/50782)                    
Test acc:
 [=========================== 79/79 ==============================>]  Step: 38ms | Tot: 725ms | Loss: 1.236 | Acc: 57.900% (5790/10000)                         
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 254ms | Loss: 2.360 | Acc: 18.000% (18/100)                              
Saving..

>Epoch: 1
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s487ms | Loss: 0.935 | Acc: 66.935% (33991/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 682ms | Loss: 0.851 | Acc: 71.020% (7102/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 258ms | Loss: 1.995 | Acc: 31.000% (31/100)                              
Saving..

>Epoch: 2
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s538ms | Loss: 0.726 | Acc: 74.680% (37924/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 684ms | Loss: 0.758 | Acc: 74.630% (7463/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 257ms | Loss: 1.333 | Acc: 55.000% (55/100)                              
Saving..

>Epoch: 3
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s568ms | Loss: 0.604 | Acc: 79.134% (40186/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.688 | Acc: 77.990% (7799/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 330ms | Loss: 0.959 | Acc: 73.000% (73/100)                              
Saving..

>Epoch: 4
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s572ms | Loss: 0.532 | Acc: 81.787% (41533/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 687ms | Loss: 0.594 | Acc: 80.760% (8076/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 298ms | Loss: 0.910 | Acc: 66.000% (66/100)                              
Saving..

>Epoch: 5
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s593ms | Loss: 0.472 | Acc: 83.738% (42524/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 696ms | Loss: 0.572 | Acc: 81.230% (8123/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 258ms | Loss: 0.550 | Acc: 81.000% (81/100)                              
Saving..

>Epoch: 6
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s580ms | Loss: 0.420 | Acc: 85.491% (43414/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 693ms | Loss: 0.568 | Acc: 81.450% (8145/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 7ms | Tot: 251ms | Loss: 0.435 | Acc: 85.000% (85/100)                              
Saving..

>Epoch: 7
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s615ms | Loss: 0.392 | Acc: 86.414% (43883/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 692ms | Loss: 0.544 | Acc: 82.740% (8274/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 7ms | Tot: 252ms | Loss: 0.338 | Acc: 91.000% (91/100)                              
Saving..

>Epoch: 8
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s595ms | Loss: 0.362 | Acc: 87.505% (44437/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 688ms | Loss: 0.532 | Acc: 82.970% (8297/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 13ms | Tot: 272ms | Loss: 0.403 | Acc: 89.000% (89/100)                             
Saving..

>Epoch: 9
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s623ms | Loss: 0.333 | Acc: 88.537% (44961/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 696ms | Loss: 0.473 | Acc: 84.620% (8462/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 273ms | Loss: 0.345 | Acc: 90.000% (90/100)                              
Saving..

>Epoch: 10
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s619ms | Loss: 0.309 | Acc: 89.392% (45395/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 697ms | Loss: 0.459 | Acc: 85.540% (8554/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 4ms | Tot: 268ms | Loss: 0.252 | Acc: 92.000% (92/100)                              
Saving..

>Epoch: 11
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s610ms | Loss: 0.289 | Acc: 89.959% (45683/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 691ms | Loss: 0.384 | Acc: 87.480% (8748/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 4ms | Tot: 277ms | Loss: 0.202 | Acc: 94.000% (94/100)                              
Saving..

>Epoch: 12
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s641ms | Loss: 0.271 | Acc: 90.713% (46066/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 693ms | Loss: 0.539 | Acc: 83.760% (8376/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 259ms | Loss: 0.198 | Acc: 94.000% (94/100)                              
Saving..

>Epoch: 13
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s632ms | Loss: 0.254 | Acc: 91.123% (46274/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 692ms | Loss: 0.424 | Acc: 86.610% (8661/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 258ms | Loss: 0.137 | Acc: 96.000% (96/100)                              
Saving..

>Epoch: 14
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s656ms | Loss: 0.242 | Acc: 91.619% (46526/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 693ms | Loss: 0.506 | Acc: 84.910% (8491/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 235ms | Loss: 0.208 | Acc: 94.000% (94/100)                              
Saving..

>Epoch: 15
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s655ms | Loss: 0.229 | Acc: 92.044% (46742/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 691ms | Loss: 0.395 | Acc: 87.070% (8707/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 265ms | Loss: 0.164 | Acc: 96.000% (96/100)                              
Saving..

>Epoch: 16
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s671ms | Loss: 0.211 | Acc: 92.651% (47050/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 692ms | Loss: 0.460 | Acc: 86.480% (8648/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 4ms | Tot: 311ms | Loss: 0.152 | Acc: 94.000% (94/100)                              
Saving..

>Epoch: 17
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s639ms | Loss: 0.206 | Acc: 92.940% (47197/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 701ms | Loss: 0.363 | Acc: 88.880% (8888/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 266ms | Loss: 0.136 | Acc: 96.000% (96/100)                              
Saving..

Epoch: 18
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s620ms | Loss: 0.193 | Acc: 93.216% (47337/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.400 | Acc: 88.020% (8802/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 324ms | Loss: 0.279 | Acc: 91.000% (91/100)                              
Saving..

Epoch: 19
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s645ms | Loss: 0.187 | Acc: 93.439% (47450/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 689ms | Loss: 0.392 | Acc: 88.310% (8831/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 305ms | Loss: 0.191 | Acc: 93.000% (93/100)                              
Saving..

Epoch: 20
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s705ms | Loss: 0.106 | Acc: 96.459% (48984/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 691ms | Loss: 0.277 | Acc: 91.680% (9168/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 6ms | Tot: 284ms | Loss: 0.021 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 21
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s609ms | Loss: 0.084 | Acc: 97.298% (49410/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 688ms | Loss: 0.275 | Acc: 92.090% (9209/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 284ms | Loss: 0.017 | Acc: 99.000% (99/100)                              
Saving..

Epoch: 22
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s603ms | Loss: 0.075 | Acc: 97.513% (49519/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 687ms | Loss: 0.275 | Acc: 92.410% (9241/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 300ms | Loss: 0.012 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 23
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s619ms | Loss: 0.067 | Acc: 97.838% (49684/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 686ms | Loss: 0.279 | Acc: 92.310% (9231/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 277ms | Loss: 0.012 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 24
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s604ms | Loss: 0.062 | Acc: 97.926% (49729/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.277 | Acc: 92.420% (9242/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 4ms | Tot: 316ms | Loss: 0.012 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 25
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s569ms | Loss: 0.059 | Acc: 98.074% (49804/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 687ms | Loss: 0.286 | Acc: 92.350% (9235/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 313ms | Loss: 0.009 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 26
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s607ms | Loss: 0.055 | Acc: 98.200% (49868/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 686ms | Loss: 0.299 | Acc: 92.010% (9201/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 275ms | Loss: 0.008 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 27
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s624ms | Loss: 0.051 | Acc: 98.289% (49913/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 693ms | Loss: 0.293 | Acc: 92.330% (9233/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 262ms | Loss: 0.008 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 28
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s601ms | Loss: 0.049 | Acc: 98.373% (49956/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 686ms | Loss: 0.295 | Acc: 92.240% (9224/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 277ms | Loss: 0.005 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 29
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s610ms | Loss: 0.047 | Acc: 98.501% (50021/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 693ms | Loss: 0.297 | Acc: 92.330% (9233/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 310ms | Loss: 0.005 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 30
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s585ms | Loss: 0.043 | Acc: 98.612% (50077/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 687ms | Loss: 0.305 | Acc: 92.290% (9229/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 283ms | Loss: 0.005 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 31
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s616ms | Loss: 0.042 | Acc: 98.602% (50072/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 691ms | Loss: 0.307 | Acc: 92.330% (9233/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 282ms | Loss: 0.003 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 32
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s600ms | Loss: 0.038 | Acc: 98.832% (50189/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 689ms | Loss: 0.307 | Acc: 92.360% (9236/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 304ms | Loss: 0.004 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 33
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s607ms | Loss: 0.036 | Acc: 98.862% (50204/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 689ms | Loss: 0.319 | Acc: 92.410% (9241/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 278ms | Loss: 0.002 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 34
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s627ms | Loss: 0.035 | Acc: 98.840% (50193/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 696ms | Loss: 0.312 | Acc: 92.440% (9244/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 8ms | Tot: 246ms | Loss: 0.002 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 35
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s677ms | Loss: 0.033 | Acc: 98.952% (50250/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 685ms | Loss: 0.325 | Acc: 92.340% (9234/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 5ms | Tot: 261ms | Loss: 0.002 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 36
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s597ms | Loss: 0.030 | Acc: 99.033% (50291/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 686ms | Loss: 0.321 | Acc: 92.580% (9258/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 272ms | Loss: 0.002 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 37
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s622ms | Loss: 0.031 | Acc: 99.013% (50281/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 693ms | Loss: 0.327 | Acc: 92.510% (9251/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 251ms | Loss: 0.003 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 38
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s624ms | Loss: 0.029 | Acc: 99.082% (50316/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.323 | Acc: 92.370% (9237/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 316ms | Loss: 0.002 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 39
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s622ms | Loss: 0.027 | Acc: 99.153% (50352/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.333 | Acc: 92.450% (9245/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 239ms | Loss: 0.003 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 40
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s640ms | Loss: 0.023 | Acc: 99.307% (50430/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.329 | Acc: 92.550% (9255/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 13ms | Tot: 268ms | Loss: 0.001 | Acc: 100.000% (100/100)                           
Saving..

Epoch: 41
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s621ms | Loss: 0.022 | Acc: 99.358% (50456/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.327 | Acc: 92.530% (9253/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 258ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 42
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s621ms | Loss: 0.022 | Acc: 99.362% (50458/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 689ms | Loss: 0.328 | Acc: 92.600% (9260/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 12ms | Tot: 268ms | Loss: 0.001 | Acc: 100.000% (100/100)                           
Saving..

Epoch: 43
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s613ms | Loss: 0.021 | Acc: 99.395% (50475/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 691ms | Loss: 0.328 | Acc: 92.610% (9261/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 32ms | Tot: 296ms | Loss: 0.001 | Acc: 100.000% (100/100)                           
Saving..

Epoch: 44
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s613ms | Loss: 0.021 | Acc: 99.350% (50452/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.326 | Acc: 92.660% (9266/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 259ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 45
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s616ms | Loss: 0.021 | Acc: 99.403% (50479/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 692ms | Loss: 0.326 | Acc: 92.580% (9258/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 293ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 46
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s624ms | Loss: 0.021 | Acc: 99.392% (50473/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 687ms | Loss: 0.327 | Acc: 92.560% (9256/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 271ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 47
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s612ms | Loss: 0.020 | Acc: 99.380% (50467/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 692ms | Loss: 0.329 | Acc: 92.590% (9259/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 240ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 48
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s614ms | Loss: 0.019 | Acc: 99.464% (50510/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 688ms | Loss: 0.329 | Acc: 92.690% (9269/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 310ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 49
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s612ms | Loss: 0.020 | Acc: 99.417% (50486/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 689ms | Loss: 0.327 | Acc: 92.630% (9263/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 6ms | Tot: 271ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 50
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s604ms | Loss: 0.021 | Acc: 99.374% (50464/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 683ms | Loss: 0.329 | Acc: 92.680% (9268/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 6ms | Tot: 274ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 51
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s610ms | Loss: 0.020 | Acc: 99.462% (50509/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 678ms | Loss: 0.330 | Acc: 92.630% (9263/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 274ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 52
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s600ms | Loss: 0.019 | Acc: 99.490% (50523/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.328 | Acc: 92.670% (9267/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 297ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 53
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s629ms | Loss: 0.019 | Acc: 99.472% (50514/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 692ms | Loss: 0.329 | Acc: 92.660% (9266/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 257ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 54
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s592ms | Loss: 0.019 | Acc: 99.456% (50506/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 688ms | Loss: 0.331 | Acc: 92.680% (9268/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 263ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 55
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s620ms | Loss: 0.019 | Acc: 99.478% (50517/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 0.331 | Acc: 92.620% (9262/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 7ms | Tot: 257ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

Epoch: 56
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s626ms | Loss: 0.020 | Acc: 99.409% (50482/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 689ms | Loss: 0.332 | Acc: 92.680% (9268/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 291ms | Loss: 0.001 | Acc: 100.000% (100/100)                            
Saving..

>Epoch: 57
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 12s601ms | Loss: 0.018 | Acc: 99.500% (50528/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 687ms | Loss: 0.333 | Acc: 92.570% (9257/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 11ms | Tot: 274ms | Loss: 0.001 | Acc: 100.000% (100/100)                           
Saving..

>Epoch: 58
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s609ms | Loss: 0.018 | Acc: 99.506% (50531/50782)                     
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 691ms | Loss: 0.335 | Acc: 92.650% (9265/10000)                          
WM acc:
 [=========================== 50/50 =============================>.]  Step: 21ms | Tot: 262ms | Loss: 0.001 | Acc: 100.000% (100/100)                           
Saving..

>Epoch: 59
 [===== 391/391 =====>]  Step: 23ms | Tot: 12s624ms | Loss: 0.019 | Acc: 99.468% (50512/50782)                     
Test acc:
 [===== 79/79 =====>]  Step: 3ms | Tot: 694ms | Loss: 0.329 | Acc: 92.690% (9269/10000)                          
WM acc:
 [===== 50/50=====>.]  Step: 2ms | Tot: 269ms | Loss: 0.001 | Acc: 100.000% (100/100)   

## predict.py
py脚本允许您在CIFAR10测试集或提供的触发器集上测试模型。要在CIFAR10数据集(没有triqqer集)上测试训练过的模型，运行以下命令:

`python predict.py --model_path checkpoint/model.t7`
>(linshen) weili@dell:~/Scientific-research/WatermarkNN02$ python predict.py --model_path checkpoint/model.t7
==> Preparing data..
Using CIFAR10 dataset.
Files already downloaded and verified
Files already downloaded and verified
==> Resuming from checkpoint..
 [======= 100/100 ======>]  Step: 7ms | Tot: 760ms | Loss: 0.327 | Acc: 92.690% (9269/10000)       

要在指定的触发器集中测试训练过的模型，请运行以下命令:
`python predict.py --model_path checkpoint/model.t7 --wm_path ./data/trigger_set --wm_lbl labels-cifar.txt --testwm`
>(linshen) weili@dell:~/Scientific-research/WatermarkNN02$ python predict.py --model_path checkpoint/model.t7 --wm_path ./data/trigger_set --wm_lbl labels-cifar.txt --testwm
Loading watermark images
==> Resuming from checkpoint..
 [>.............. 1/1 ......]  Step: 3s304ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                

 
>Below we provide example scripts for all four fine-tuning techniques.

## Fine-Tuning

### Fine-Tune Last Layer (FTLL)
`python fine-tune.py --lr 0.01 --load_path checkpoint/model.t7 --save_dir checkpoint/ --save_model ftll.t7 --runname fine.tune.last.layer --dataset cifar10`

WM acc:
 [>.......................... 1/1 .................................]  Step: 11s962ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s495ms | Loss: 0.327 | Acc: 92.690% (9269/10000)                       

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s32ms | Loss: 0.020 | Acc: 99.410% (49705/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s395ms | Loss: 0.350 | Acc: 92.640% (9264/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s834ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s185ms | Loss: 0.020 | Acc: 99.364% (49682/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s426ms | Loss: 0.362 | Acc: 92.550% (9255/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s863ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s102ms | Loss: 0.019 | Acc: 99.376% (49688/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s415ms | Loss: 0.365 | Acc: 92.670% (9267/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s819ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s31ms | Loss: 0.019 | Acc: 99.402% (49701/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s419ms | Loss: 0.372 | Acc: 92.550% (9255/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s840ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s93ms | Loss: 0.018 | Acc: 99.420% (49710/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s402ms | Loss: 0.381 | Acc: 92.600% (9260/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s835ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s24ms | Loss: 0.020 | Acc: 99.372% (49686/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s390ms | Loss: 0.383 | Acc: 92.640% (9264/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s848ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 13ms | Tot: 8s92ms | Loss: 0.018 | Acc: 99.458% (49729/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s413ms | Loss: 0.384 | Acc: 92.590% (9259/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s837ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 15ms | Tot: 8s91ms | Loss: 0.017 | Acc: 99.418% (49709/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s439ms | Loss: 0.384 | Acc: 92.630% (9263/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s857ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 15ms | Tot: 8s33ms | Loss: 0.017 | Acc: 99.386% (49693/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s412ms | Loss: 0.390 | Acc: 92.640% (9264/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s818ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s57ms | Loss: 0.019 | Acc: 99.374% (49687/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s430ms | Loss: 0.395 | Acc: 92.590% (9259/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s843ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s71ms | Loss: 0.018 | Acc: 99.372% (49686/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s421ms | Loss: 0.392 | Acc: 92.570% (9257/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s835ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s84ms | Loss: 0.017 | Acc: 99.456% (49728/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s433ms | Loss: 0.396 | Acc: 92.640% (9264/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s839ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s45ms | Loss: 0.017 | Acc: 99.408% (49704/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s419ms | Loss: 0.399 | Acc: 92.540% (9254/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s835ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s58ms | Loss: 0.019 | Acc: 99.358% (49679/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s422ms | Loss: 0.398 | Acc: 92.610% (9261/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s839ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s71ms | Loss: 0.017 | Acc: 99.416% (49708/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s411ms | Loss: 0.397 | Acc: 92.560% (9256/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s827ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s80ms | Loss: 0.018 | Acc: 99.426% (49713/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s401ms | Loss: 0.400 | Acc: 92.530% (9253/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s851ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s79ms | Loss: 0.018 | Acc: 99.368% (49684/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s426ms | Loss: 0.392 | Acc: 92.740% (9274/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s868ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s44ms | Loss: 0.018 | Acc: 99.394% (49697/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s395ms | Loss: 0.394 | Acc: 92.580% (9258/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s833ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s151ms | Loss: 0.019 | Acc: 99.356% (49678/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s454ms | Loss: 0.396 | Acc: 92.620% (9262/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 2s855ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s646ms | Loss: 0.018 | Acc: 99.402% (49701/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 769ms | Loss: 0.397 | Acc: 92.550% (9255/10000)                          
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s114ms | Tot: 0ms | Loss: 0.000 | Acc: 100.000% (100/100)                          
Saving..


### Fine-Tune All Layers (FTAL)
`python fine-tune.py --lr 0.01 --load_path checkpoint/model.t7 --save_dir checkpoint/ --save_model ftal.t7 --runname fine.tune.all.layers --tunealllayers --dataset cifar10`

==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 12s260ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s458ms | Loss: 0.327 | Acc: 92.690% (9269/10000)                       

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 35ms | Tot: 18s239ms | Loss: 0.259 | Acc: 91.234% (45617/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s539ms | Loss: 0.372 | Acc: 88.750% (8875/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s199ms | Tot: 0ms | Loss: 1.024 | Acc: 61.000% (61/100)                            
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s344ms | Loss: 0.208 | Acc: 92.674% (46337/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s499ms | Loss: 0.393 | Acc: 88.300% (8830/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s211ms | Tot: 0ms | Loss: 1.113 | Acc: 57.000% (57/100)                            
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s313ms | Loss: 0.191 | Acc: 93.314% (46657/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s499ms | Loss: 0.446 | Acc: 86.930% (8693/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s199ms | Tot: 0ms | Loss: 1.343 | Acc: 54.000% (54/100)                            
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s359ms | Loss: 0.179 | Acc: 93.740% (46870/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s503ms | Loss: 0.459 | Acc: 87.530% (8753/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s181ms | Tot: 0ms | Loss: 1.946 | Acc: 39.000% (39/100)                            
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s379ms | Loss: 0.171 | Acc: 94.014% (47007/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s526ms | Loss: 0.353 | Acc: 89.500% (8950/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s207ms | Tot: 0ms | Loss: 1.789 | Acc: 43.000% (43/100)                            
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s428ms | Loss: 0.162 | Acc: 94.384% (47192/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s497ms | Loss: 0.353 | Acc: 89.600% (8960/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s182ms | Tot: 0ms | Loss: 2.195 | Acc: 38.000% (38/100)                            
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 38ms | Tot: 18s425ms | Loss: 0.154 | Acc: 94.534% (47267/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s512ms | Loss: 0.354 | Acc: 89.630% (8963/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s187ms | Tot: 0ms | Loss: 2.211 | Acc: 41.000% (41/100)                            
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s426ms | Loss: 0.148 | Acc: 94.754% (47377/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s518ms | Loss: 0.326 | Acc: 89.820% (8982/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s195ms | Tot: 0ms | Loss: 2.495 | Acc: 26.000% (26/100)                            
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s401ms | Loss: 0.140 | Acc: 95.060% (47530/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s527ms | Loss: 0.361 | Acc: 89.350% (8935/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s198ms | Tot: 0ms | Loss: 2.395 | Acc: 27.000% (27/100)                            
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s415ms | Loss: 0.136 | Acc: 95.252% (47626/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s511ms | Loss: 0.410 | Acc: 88.410% (8841/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s186ms | Tot: 0ms | Loss: 2.762 | Acc: 25.000% (25/100)                            
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s428ms | Loss: 0.128 | Acc: 95.428% (47714/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s519ms | Loss: 0.431 | Acc: 88.600% (8860/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s250ms | Tot: 0ms | Loss: 2.813 | Acc: 28.000% (28/100)                            
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s413ms | Loss: 0.126 | Acc: 95.502% (47751/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s490ms | Loss: 0.390 | Acc: 89.320% (8932/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s200ms | Tot: 0ms | Loss: 2.842 | Acc: 27.000% (27/100)                            
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s440ms | Loss: 0.118 | Acc: 95.864% (47932/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s502ms | Loss: 0.390 | Acc: 89.610% (8961/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s224ms | Tot: 0ms | Loss: 2.824 | Acc: 33.000% (33/100)                            
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s506ms | Loss: 0.113 | Acc: 96.130% (48065/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s545ms | Loss: 0.370 | Acc: 89.630% (8963/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s234ms | Tot: 0ms | Loss: 2.900 | Acc: 27.000% (27/100)                            
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s459ms | Loss: 0.112 | Acc: 96.014% (48007/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s543ms | Loss: 0.352 | Acc: 90.310% (9031/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s219ms | Tot: 0ms | Loss: 2.781 | Acc: 28.000% (28/100)                            
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s391ms | Loss: 0.108 | Acc: 96.210% (48105/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s504ms | Loss: 0.410 | Acc: 88.730% (8873/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s181ms | Tot: 0ms | Loss: 3.512 | Acc: 27.000% (27/100)                            
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s467ms | Loss: 0.106 | Acc: 96.332% (48166/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s526ms | Loss: 0.348 | Acc: 90.080% (9008/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s226ms | Tot: 0ms | Loss: 3.234 | Acc: 27.000% (27/100)                            
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s442ms | Loss: 0.105 | Acc: 96.282% (48141/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s525ms | Loss: 0.376 | Acc: 89.760% (8976/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s214ms | Tot: 0ms | Loss: 3.467 | Acc: 20.000% (20/100)                            
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s473ms | Loss: 0.097 | Acc: 96.538% (48269/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s522ms | Loss: 0.387 | Acc: 89.510% (8951/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s201ms | Tot: 0ms | Loss: 4.027 | Acc: 23.000% (23/100)                            
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s452ms | Loss: 0.098 | Acc: 96.532% (48266/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s494ms | Loss: 0.362 | Acc: 90.440% (9044/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s219ms | Tot: 0ms | Loss: 3.557 | Acc: 21.000% (21/100)                            
Saving..

### Retrain Last Layer (RTLL)
`python fine-tune.py --lr 0.01 --load_path checkpoint/model.t7 --save_dir checkpoint/ --save_model rtll.t7 --runname reinit.last.layer --reinitll --dataset cifar10`

==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 12s353ms | Tot: 0ms | Loss: 2.504 | Acc: 2.000% (2/100)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s470ms | Loss: 2.525 | Acc: 3.970% (397/10000)                         

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s929ms | Loss: 0.043 | Acc: 98.900% (49450/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s368ms | Loss: 0.323 | Acc: 92.550% (9255/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s217ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s997ms | Loss: 0.022 | Acc: 99.324% (49662/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s397ms | Loss: 0.347 | Acc: 92.490% (9249/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s202ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 15ms | Tot: 8s15ms | Loss: 0.019 | Acc: 99.422% (49711/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s404ms | Loss: 0.359 | Acc: 92.610% (9261/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s211ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s979ms | Loss: 0.020 | Acc: 99.370% (49685/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s378ms | Loss: 0.364 | Acc: 92.590% (9259/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s218ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s13ms | Loss: 0.019 | Acc: 99.362% (49681/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s407ms | Loss: 0.367 | Acc: 92.610% (9261/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s192ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s131ms | Loss: 0.019 | Acc: 99.410% (49705/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s454ms | Loss: 0.378 | Acc: 92.590% (9259/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s257ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s92ms | Loss: 0.019 | Acc: 99.426% (49713/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s389ms | Loss: 0.373 | Acc: 92.660% (9266/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s235ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s | Loss: 0.018 | Acc: 99.390% (49695/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s408ms | Loss: 0.382 | Acc: 92.630% (9263/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s204ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s997ms | Loss: 0.018 | Acc: 99.420% (49710/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s400ms | Loss: 0.388 | Acc: 92.630% (9263/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s219ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 15ms | Tot: 8s51ms | Loss: 0.019 | Acc: 99.370% (49685/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s412ms | Loss: 0.389 | Acc: 92.560% (9256/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s237ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s990ms | Loss: 0.017 | Acc: 99.410% (49705/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s401ms | Loss: 0.392 | Acc: 92.540% (9254/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s191ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s32ms | Loss: 0.018 | Acc: 99.396% (49698/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s434ms | Loss: 0.394 | Acc: 92.680% (9268/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s211ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s26ms | Loss: 0.019 | Acc: 99.342% (49671/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s406ms | Loss: 0.392 | Acc: 92.640% (9264/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s226ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 15ms | Tot: 8s32ms | Loss: 0.017 | Acc: 99.482% (49741/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s411ms | Loss: 0.392 | Acc: 92.560% (9256/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s222ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s27ms | Loss: 0.018 | Acc: 99.348% (49674/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s417ms | Loss: 0.392 | Acc: 92.580% (9258/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s242ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s993ms | Loss: 0.017 | Acc: 99.444% (49722/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s433ms | Loss: 0.394 | Acc: 92.650% (9265/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s218ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s36ms | Loss: 0.018 | Acc: 99.372% (49686/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s395ms | Loss: 0.394 | Acc: 92.660% (9266/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s209ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 7s984ms | Loss: 0.018 | Acc: 99.406% (49703/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 1s420ms | Loss: 0.396 | Acc: 92.490% (9249/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s203ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s4ms | Loss: 0.018 | Acc: 99.386% (49693/50000)                        
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s427ms | Loss: 0.397 | Acc: 92.620% (9262/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s211ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 16ms | Tot: 8s99ms | Loss: 0.018 | Acc: 99.380% (49690/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s420ms | Loss: 0.398 | Acc: 92.520% (9252/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s228ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                          
Saving..

### Retrain All Layers (RTAL)
`python fine-tune.py --lr 0.01 --load_path checkpoint/model.t7 --save_dir checkpoint/ --save_model rtal.t7 --runname reinit_all.layers --reinitll --tunealllayers  --dataset cifar10`
WM acc:
 [>.......................... 1/1 .................................]  Step: 12s306ms | Tot: 0ms | Loss: 2.272 | Acc: 7.000% (7/100)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s475ms | Loss: 2.330 | Acc: 17.260% (1726/10000)                       

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s219ms | Loss: 0.258 | Acc: 91.288% (45644/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s519ms | Loss: 0.454 | Acc: 86.790% (8679/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s281ms | Tot: 0ms | Loss: 1.875 | Acc: 51.000% (51/100)                            
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s463ms | Loss: 0.209 | Acc: 92.626% (46313/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 16ms | Tot: 1s480ms | Loss: 0.393 | Acc: 88.590% (8859/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s252ms | Tot: 0ms | Loss: 1.507 | Acc: 60.000% (60/100)                            
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s407ms | Loss: 0.194 | Acc: 93.254% (46627/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s486ms | Loss: 0.368 | Acc: 89.150% (8915/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s241ms | Tot: 0ms | Loss: 1.718 | Acc: 48.000% (48/100)                            
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s436ms | Loss: 0.181 | Acc: 93.532% (46766/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s511ms | Loss: 0.435 | Acc: 87.770% (8777/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s229ms | Tot: 0ms | Loss: 2.365 | Acc: 41.000% (41/100)                            
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s474ms | Loss: 0.174 | Acc: 93.902% (46951/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s503ms | Loss: 0.358 | Acc: 89.180% (8918/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s246ms | Tot: 0ms | Loss: 2.175 | Acc: 41.000% (41/100)                            
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s460ms | Loss: 0.166 | Acc: 94.202% (47101/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s542ms | Loss: 0.416 | Acc: 88.190% (8819/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s227ms | Tot: 0ms | Loss: 2.250 | Acc: 44.000% (44/100)                            
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s420ms | Loss: 0.160 | Acc: 94.436% (47218/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s533ms | Loss: 0.329 | Acc: 90.110% (9011/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s259ms | Tot: 0ms | Loss: 1.931 | Acc: 40.000% (40/100)                            
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s602ms | Loss: 0.142 | Acc: 95.056% (47528/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s529ms | Loss: 0.382 | Acc: 89.200% (8920/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s311ms | Tot: 0ms | Loss: 2.789 | Acc: 31.000% (31/100)                            
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s532ms | Loss: 0.138 | Acc: 95.118% (47559/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s510ms | Loss: 0.375 | Acc: 89.180% (8918/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s251ms | Tot: 0ms | Loss: 3.034 | Acc: 29.000% (29/100)                            
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s456ms | Loss: 0.139 | Acc: 95.106% (47553/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s502ms | Loss: 0.378 | Acc: 89.190% (8919/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s248ms | Tot: 0ms | Loss: 2.748 | Acc: 29.000% (29/100)                            
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s463ms | Loss: 0.127 | Acc: 95.542% (47771/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s515ms | Loss: 0.387 | Acc: 89.190% (8919/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s239ms | Tot: 0ms | Loss: 3.038 | Acc: 29.000% (29/100)                            
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s449ms | Loss: 0.128 | Acc: 95.496% (47748/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s491ms | Loss: 0.410 | Acc: 88.660% (8866/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s263ms | Tot: 0ms | Loss: 2.643 | Acc: 26.000% (26/100)                            
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s498ms | Loss: 0.122 | Acc: 95.728% (47864/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s542ms | Loss: 0.352 | Acc: 90.280% (9028/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s232ms | Tot: 0ms | Loss: 2.676 | Acc: 26.000% (26/100)                            
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s492ms | Loss: 0.114 | Acc: 96.022% (48011/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s526ms | Loss: 0.360 | Acc: 89.910% (8991/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s240ms | Tot: 0ms | Loss: 2.983 | Acc: 25.000% (25/100)                            
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 38ms | Tot: 18s469ms | Loss: 0.113 | Acc: 96.046% (48023/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s497ms | Loss: 0.366 | Acc: 90.180% (9018/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s241ms | Tot: 0ms | Loss: 2.958 | Acc: 22.000% (22/100)                            
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s476ms | Loss: 0.105 | Acc: 96.264% (48132/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s488ms | Loss: 0.406 | Acc: 89.320% (8932/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s219ms | Tot: 0ms | Loss: 3.321 | Acc: 23.000% (23/100)                            
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 36ms | Tot: 18s451ms | Loss: 0.107 | Acc: 96.226% (48113/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s487ms | Loss: 0.352 | Acc: 90.310% (9031/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s263ms | Tot: 0ms | Loss: 3.688 | Acc: 14.000% (14/100)                            
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s486ms | Loss: 0.098 | Acc: 96.578% (48289/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s498ms | Loss: 0.420 | Acc: 89.000% (8900/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s262ms | Tot: 0ms | Loss: 2.900 | Acc: 26.000% (26/100)                            
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s472ms | Loss: 0.100 | Acc: 96.444% (48222/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 14ms | Tot: 1s491ms | Loss: 0.381 | Acc: 90.000% (9000/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s270ms | Tot: 0ms | Loss: 3.668 | Acc: 18.000% (18/100)                            
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 37ms | Tot: 18s455ms | Loss: 0.097 | Acc: 96.654% (48327/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 1s502ms | Loss: 0.375 | Acc: 89.900% (8990/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 3s256ms | Tot: 0ms | Loss: 3.237 | Acc: 26.000% (26/100)                            
Saving..