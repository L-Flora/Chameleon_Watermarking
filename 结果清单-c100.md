[toc]

## 成功的案例：
### 训练阶段
#### 无水印训练模型
`python train.py --batch_size 128 --max_epochs 60 --runname WMtrain100 --wm_batch_size 2 --dataset cifar100 --lr 0.01 ` 
Epoch: 57
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 13s597ms | Loss: 0.121 | Acc: 97.126% (48563/50000)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 4ms | Tot: 785ms | Loss: 1.201 | Acc: 72.220% (7222/10000)                        
Saving..

Epoch: 58
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 13s658ms | Loss: 0.120 | Acc: 97.154% (48577/50000)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 4ms | Tot: 813ms | Loss: 1.203 | Acc: 72.170% (7217/10000)                        
Saving..

Epoch: 59
 [=========================== 391/391 ============================>]  Step: 21ms | Tot: 13s565ms | Loss: 0.117 | Acc: 97.172% (48586/50000)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 782ms | Loss: 1.201 | Acc: 72.310% (7231/10000)                        
Saving..

`python train.py --batch_size 128 --max_epochs 60 --runname WMtrain100 --wm_batch_size 2 --dataset cifar100 --lr 0.01 --save_model non-wm-model-100.t7`:
Epoch: 0
 [=========================== 391/391 ============================>]  Step: 558ms | Tot: 24s191ms | Loss: 3.707 | Acc: 12.890% (6445/50000)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 172ms | Tot: 1s696ms | Loss: 3.325 | Acc: 19.330% (1933/10000)                    
Saving..

Epoch: 59
 [=========================== 391/391 ============================>]  Step: 22ms | Tot: 14s820ms | Loss: 0.124 | Acc: 97.032% (48516/50000)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 871ms | Loss: 1.207 | Acc: 72.120% (7212/10000)                        
Saving..

程序用时为： 1408.635608769022 s

#### 有水印训练模型
`python train.py --batch_size 128 --max_epochs 60 --runname WMtrain100-wm --wm_batch_size 2 --dataset cifar100 --lr 0.01 --wmtrain --save_model model-100.t7` 
==> Preparing data..
Using CIFAR100 dataset.
Files already downloaded and verified
Files already downloaded and verified
Loading watermark images
==> Building model..
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [=========================== 50/50 =============================>.]  Step: 11ms | Tot: 259ms | Loss: 4.599 | Acc: 11.000% (11/100)                           

Epoch: 0
 [=========================== 391/391 ============================>]  Step: 215ms | Tot: 12s642ms | Loss: 3.735 | Acc: 12.676% (6437/50782)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 36ms | Tot: 719ms | Loss: 3.320 | Acc: 20.790% (2079/10000)                       
WM acc:
 [=========================== 50/50 =============================>.]  Step: 52ms | Tot: 325ms | Loss: 4.181 | Acc: 10.000% (10/100)                           
Saving..

Epoch: 1
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s465ms | Loss: 2.916 | Acc: 25.944% (13175/50782)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 686ms | Loss: 2.914 | Acc: 27.050% (2705/10000)                        
WM acc:
 [=========================== 50/50 =============================>.]  Step: 4ms | Tot: 332ms | Loss: 2.602 | Acc: 25.000% (25/100)                            
Saving..

Epoch: 2
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s543ms | Loss: 2.428 | Acc: 35.641% (18099/50782)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 684ms | Loss: 2.471 | Acc: 36.500% (3650/10000)                        
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 305ms | Loss: 2.167 | Acc: 36.000% (36/100)                            
Saving..

···

Epoch: 58
 [=========================== 391/391 ============================>]  Step: 25ms | Tot: 12s731ms | Loss: 0.122 | Acc: 97.139% (49329/50782)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 699ms | Loss: 1.195 | Acc: 72.260% (7226/10000)                        
WM acc:
 [=========================== 50/50 =============================>.]  Step: 3ms | Tot: 310ms | Loss: 0.002 | Acc: 100.000% (100/100)                          
Saving..

Epoch: 59
 [=========================== 391/391 ============================>]  Step: 23ms | Tot: 12s730ms | Loss: 0.121 | Acc: 97.117% (49318/50782)                   
Test acc:
 [=========================== 79/79 ==============================>]  Step: 3ms | Tot: 690ms | Loss: 1.198 | Acc: 72.270% (7227/10000)                        
WM acc:
 [=========================== 50/50 =============================>.]  Step: 2ms | Tot: 286ms | Loss: 0.002 | Acc: 100.000% (100/100)                          
Saving..
程序用时为： 1240.846625203034 s

### 预测阶段

#### 无水印模型的预测

py脚本允许您在CIFAR10测试集或提供的触发器集上测试模型。要在CIFAR10数据集(没有triqqer集)上测试无水印模型，运行以下命令:

`python predict.py --model_path checkpoint/non-wm-model-100.t7 --db_path cifar100`

(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python predict.py --model_path checkpoint/non-wm-model-100.t7
==> Preparing data..
Using CIFAR100 dataset.
Files already downloaded and verified
Files already downloaded and verified
==> Resuming from checkpoint..
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 823ms | Loss: 1.207 | Acc: 72.120% (7212/10000)  

要在指定的触发器集中测试干净模型，请运行以下命令:
`python predict.py --model_path checkpoint/non-wm-model-100.t7 --wm_path ./data/trigger_set --wm_lbl labels-cifar.txt --testwm`

(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python predict.py --model_path checkpoint/non-wm-model-100.t7 --wm_path ./data/trigger_set --wm_lbl labels-cifar.txt --testwm
Loading watermark images
==> Resuming from checkpoint..
 [>.......................... 1/1 .................................]  Step: 3s697ms | Tot: 0ms | Loss: 13.229 | Acc: 1.000% (1/100)   

#### 有水印训练模型

py脚本允许您在CIFAR10测试集或提供的触发器集上测试模型。要在CIFAR10数据集(没有triqqer集)上测试带水印的模型，运行以下命令:

`python predict.py --model_path checkpoint/model-100.t7 `

(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python predict.py --model_path checkpoint/model-100.t7==> Preparing data..
Using CIFAR100 dataset.
Files already downloaded and verified
Files already downloaded and verified
==> Resuming from checkpoint..
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 827ms | Loss: 1.195 | Acc: 72.270% (7227/10000)       

要在指定的触发器集中测试干净模型，请运行以下命令:
`python predict.py --model_path checkpoint/model-100.t7 --wm_path ./data/trigger_set --wm_lbl labels-cifar.txt --testwm`

(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python predict.py --model_path checkpoint/model-100.t7 --wm_path ./data/trigger_set --wm_lbl labels-cifar.txt --testwm
Loading watermark images
==> Resuming from checkpoint..
 [>.......................... 1/1 .................................]  Step: 3s651ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)       



## Fine-Tuning
>Below we provide example scripts for all four fine-tuning techniques.

### Fine-Tune Last Layer (FTLL)

干净：
`python fine-tune.py --lr 0.01 --load_path checkpoint/non-wm-model-100.t7 --save_dir checkpoint/ --save_model ftll.t7 --runname fine.tune.last.layer --dataset cifar100 `

==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s925ms | Tot: 0ms | Loss: 13.229 | Acc: 1.000% (1/100)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 827ms | Loss: 1.207 | Acc: 72.120% (7212/10000)  

 
Epoch: 59
 [=========================== 500/500 ============================>]  Step: 15ms | Tot: 4s427ms | Loss: 0.131 | Acc: 96.614% (48307/50000)                    
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 806ms | Loss: 1.254 | Acc: 71.980% (7198/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s277ms | Tot: 0ms | Loss: 13.717 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s451ms | Loss: 0.128 | Acc: 96.472% (48236/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 825ms | Loss: 1.285 | Acc: 72.070% (7207/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s316ms | Tot: 0ms | Loss: 13.682 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s575ms | Loss: 0.125 | Acc: 96.578% (48289/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 816ms | Loss: 1.298 | Acc: 71.890% (7189/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s238ms | Tot: 0ms | Loss: 13.919 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s392ms | Loss: 0.123 | Acc: 96.486% (48243/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 17ms | Tot: 836ms | Loss: 1.318 | Acc: 71.900% (7190/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s323ms | Tot: 0ms | Loss: 14.188 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s398ms | Loss: 0.124 | Acc: 96.406% (48203/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 813ms | Loss: 1.335 | Acc: 71.790% (7179/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s236ms | Tot: 0ms | Loss: 14.448 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s430ms | Loss: 0.123 | Acc: 96.436% (48218/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 823ms | Loss: 1.357 | Acc: 71.480% (7148/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s267ms | Tot: 0ms | Loss: 14.392 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s415ms | Loss: 0.118 | Acc: 96.590% (48295/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 822ms | Loss: 1.363 | Acc: 71.970% (7197/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s242ms | Tot: 0ms | Loss: 14.726 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s448ms | Loss: 0.119 | Acc: 96.538% (48269/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 844ms | Loss: 1.363 | Acc: 71.700% (7170/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s273ms | Tot: 0ms | Loss: 14.703 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s444ms | Loss: 0.118 | Acc: 96.574% (48287/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 817ms | Loss: 1.372 | Acc: 71.960% (7196/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s275ms | Tot: 0ms | Loss: 14.675 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s493ms | Loss: 0.118 | Acc: 96.590% (48295/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 850ms | Loss: 1.380 | Acc: 71.550% (7155/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s286ms | Tot: 0ms | Loss: 14.513 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s479ms | Loss: 0.118 | Acc: 96.492% (48246/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 853ms | Loss: 1.380 | Acc: 71.580% (7158/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s269ms | Tot: 0ms | Loss: 14.622 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s187ms | Loss: 0.116 | Acc: 96.648% (48324/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.394 | Acc: 71.370% (7137/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s134ms | Tot: 0ms | Loss: 14.875 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s17ms | Loss: 0.115 | Acc: 96.562% (48281/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 760ms | Loss: 1.391 | Acc: 71.750% (7175/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s155ms | Tot: 0ms | Loss: 15.019 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s3ms | Loss: 0.113 | Acc: 96.692% (48346/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.390 | Acc: 71.670% (7167/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s172ms | Tot: 0ms | Loss: 14.978 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s3ms | Loss: 0.115 | Acc: 96.528% (48264/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 753ms | Loss: 1.400 | Acc: 71.600% (7160/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s142ms | Tot: 0ms | Loss: 15.214 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s2ms | Loss: 0.115 | Acc: 96.592% (48296/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.399 | Acc: 71.620% (7162/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s130ms | Tot: 0ms | Loss: 15.178 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s36ms | Loss: 0.113 | Acc: 96.732% (48366/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.401 | Acc: 71.750% (7175/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s140ms | Tot: 0ms | Loss: 15.053 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s16ms | Loss: 0.113 | Acc: 96.726% (48363/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.395 | Acc: 71.780% (7178/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s137ms | Tot: 0ms | Loss: 14.971 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s995ms | Loss: 0.114 | Acc: 96.614% (48307/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.404 | Acc: 71.480% (7148/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s145ms | Tot: 0ms | Loss: 14.990 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s3ms | Loss: 0.114 | Acc: 96.566% (48283/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 769ms | Loss: 1.405 | Acc: 71.770% (7177/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s134ms | Tot: 0ms | Loss: 14.978 | Acc: 0.000% (0/100)                           
Saving..

干净：
`python fine-tune.py --lr 0.01 --load_path checkpoint/model-100.t7 --save_dir checkpoint/ --save_model ftll.t7 --runname fine.tune.last.layer --dataset cifar100 `

WM acc:
 [>.......................... 1/1 .................................]  Step: 4s634ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                        
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 760ms | Loss: 1.195 | Acc: 72.270% (7227/10000)                        

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s938ms | Loss: 0.132 | Acc: 96.512% (48256/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 749ms | Loss: 1.256 | Acc: 72.030% (7203/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s152ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s978ms | Loss: 0.126 | Acc: 96.524% (48262/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 751ms | Loss: 1.274 | Acc: 71.920% (7192/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s146ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s970ms | Loss: 0.124 | Acc: 96.610% (48305/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 751ms | Loss: 1.300 | Acc: 71.820% (7182/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s150ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s981ms | Loss: 0.121 | Acc: 96.574% (48287/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 764ms | Loss: 1.310 | Acc: 72.100% (7210/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s146ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s3ms | Loss: 0.121 | Acc: 96.634% (48317/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.321 | Acc: 71.870% (7187/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s154ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s931ms | Loss: 0.120 | Acc: 96.644% (48322/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 755ms | Loss: 1.328 | Acc: 72.080% (7208/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s155ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s19ms | Loss: 0.118 | Acc: 96.536% (48268/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 760ms | Loss: 1.351 | Acc: 71.840% (7184/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s166ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s996ms | Loss: 0.116 | Acc: 96.620% (48310/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.352 | Acc: 72.050% (7205/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s153ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s5ms | Loss: 0.116 | Acc: 96.712% (48356/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.362 | Acc: 71.850% (7185/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s149ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s996ms | Loss: 0.116 | Acc: 96.492% (48246/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.363 | Acc: 71.850% (7185/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s202ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s6ms | Loss: 0.112 | Acc: 96.760% (48380/50000)                       
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.377 | Acc: 72.010% (7201/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s149ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s998ms | Loss: 0.113 | Acc: 96.668% (48334/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 761ms | Loss: 1.378 | Acc: 71.720% (7172/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s151ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s995ms | Loss: 0.117 | Acc: 96.506% (48253/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 754ms | Loss: 1.377 | Acc: 71.910% (7191/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s162ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s11ms | Loss: 0.116 | Acc: 96.586% (48293/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.382 | Acc: 71.740% (7174/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s158ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s17ms | Loss: 0.116 | Acc: 96.518% (48259/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.384 | Acc: 71.750% (7175/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s152ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s38ms | Loss: 0.114 | Acc: 96.590% (48295/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.384 | Acc: 71.810% (7181/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s222ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s19ms | Loss: 0.111 | Acc: 96.838% (48419/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 768ms | Loss: 1.389 | Acc: 71.840% (7184/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s163ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s62ms | Loss: 0.112 | Acc: 96.680% (48340/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.393 | Acc: 71.720% (7172/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s149ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s967ms | Loss: 0.110 | Acc: 96.702% (48351/50000)                     
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.391 | Acc: 71.940% (7194/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s189ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s30ms | Loss: 0.113 | Acc: 96.676% (48338/50000)                      
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.396 | Acc: 72.020% (7202/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s162ms | Tot: 0ms | Loss: 0.001 | Acc: 100.000% (100/100)                        
Saving..


### Fine-Tune All Layers (FTAL)

干净
`python fine-tune.py --lr 0.01 --load_path checkpoint/non-wm-model-100.t7 --save_dir checkpoint/ --save_model ftal.t7 --runname fine.tune.all.layers --tunealllayers --dataset cifar100`


(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python fine-tune.py --lr 0.01 --load_path checkpoint/non-wm-model-100.t7 --save_dir checkpoint/ --save_model ftal.t7 --runname fine.tune.all.layers --tunealllayers --dataset cifar100
fine-tune.py:82: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if device is 'cuda':
fine-tune.py:115: SyntaxWarning: "is" with a literal. Did you mean "=="?
  'net': net.module if device is 'cuda' else net,
==> Preparing data..
Using CIFAR100 dataset.
Files already downloaded and verified
Files already downloaded and verified
Loading watermark images
==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s925ms | Tot: 0ms | Loss: 13.229 | Acc: 1.000% (1/100)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 800ms | Loss: 1.207 | Acc: 72.120% (7212/10000)                        

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 40ms | Tot: 14s902ms | Loss: 0.891 | Acc: 72.804% (36402/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 16ms | Tot: 826ms | Loss: 1.677 | Acc: 59.680% (5968/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s292ms | Tot: 0ms | Loss: 10.827 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s754ms | Loss: 0.730 | Acc: 77.050% (38525/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 856ms | Loss: 1.539 | Acc: 62.420% (6242/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s311ms | Tot: 0ms | Loss: 10.025 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 43ms | Tot: 14s786ms | Loss: 0.666 | Acc: 78.942% (39471/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 826ms | Loss: 1.493 | Acc: 63.180% (6318/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s293ms | Tot: 0ms | Loss: 10.918 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s867ms | Loss: 0.616 | Acc: 80.336% (40168/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 823ms | Loss: 1.482 | Acc: 63.740% (6374/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s264ms | Tot: 0ms | Loss: 10.186 | Acc: 2.000% (2/100)                           
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 42ms | Tot: 14s814ms | Loss: 0.582 | Acc: 81.272% (40636/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 825ms | Loss: 1.493 | Acc: 63.460% (6346/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s224ms | Tot: 0ms | Loss: 11.383 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 28ms | Tot: 14s772ms | Loss: 0.544 | Acc: 82.502% (41251/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 828ms | Loss: 1.627 | Acc: 63.070% (6307/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s271ms | Tot: 0ms | Loss: 11.874 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 29ms | Tot: 14s785ms | Loss: 0.512 | Acc: 83.612% (41806/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 811ms | Loss: 1.506 | Acc: 64.270% (6427/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s250ms | Tot: 0ms | Loss: 12.065 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s758ms | Loss: 0.489 | Acc: 84.258% (42129/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 820ms | Loss: 1.445 | Acc: 65.860% (6586/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s307ms | Tot: 0ms | Loss: 11.633 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 39ms | Tot: 14s808ms | Loss: 0.458 | Acc: 85.146% (42573/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 829ms | Loss: 1.476 | Acc: 65.180% (6518/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s235ms | Tot: 0ms | Loss: 12.292 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 28ms | Tot: 14s937ms | Loss: 0.434 | Acc: 85.986% (42993/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 837ms | Loss: 1.472 | Acc: 65.270% (6527/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s287ms | Tot: 0ms | Loss: 10.115 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 46ms | Tot: 14s796ms | Loss: 0.411 | Acc: 86.664% (43332/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 819ms | Loss: 1.483 | Acc: 66.960% (6696/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s260ms | Tot: 0ms | Loss: 12.442 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s783ms | Loss: 0.388 | Acc: 87.562% (43781/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 818ms | Loss: 1.432 | Acc: 66.870% (6687/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s271ms | Tot: 0ms | Loss: 11.024 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 40ms | Tot: 14s838ms | Loss: 0.376 | Acc: 87.720% (43860/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 825ms | Loss: 1.457 | Acc: 67.180% (6718/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s266ms | Tot: 0ms | Loss: 11.832 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 28ms | Tot: 14s943ms | Loss: 0.351 | Acc: 88.594% (44297/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 848ms | Loss: 1.535 | Acc: 65.790% (6579/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s278ms | Tot: 0ms | Loss: 12.033 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s847ms | Loss: 0.344 | Acc: 88.666% (44333/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 834ms | Loss: 1.574 | Acc: 65.320% (6532/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s248ms | Tot: 0ms | Loss: 12.708 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s781ms | Loss: 0.329 | Acc: 89.228% (44614/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 10ms | Tot: 834ms | Loss: 1.531 | Acc: 66.530% (6653/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s221ms | Tot: 0ms | Loss: 12.120 | Acc: 1.000% (1/100)                           
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s750ms | Loss: 0.308 | Acc: 90.044% (45022/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 824ms | Loss: 1.505 | Acc: 66.990% (6699/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s260ms | Tot: 0ms | Loss: 12.102 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s939ms | Loss: 0.304 | Acc: 90.088% (45044/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 824ms | Loss: 1.677 | Acc: 64.680% (6468/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s312ms | Tot: 0ms | Loss: 12.097 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s881ms | Loss: 0.287 | Acc: 90.606% (45303/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 829ms | Loss: 1.619 | Acc: 65.920% (6592/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s326ms | Tot: 0ms | Loss: 12.727 | Acc: 0.000% (0/100)                           
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s822ms | Loss: 0.293 | Acc: 90.568% (45284/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 824ms | Loss: 1.614 | Acc: 65.980% (6598/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s268ms | Tot: 0ms | Loss: 12.862 | Acc: 0.000% (0/100)                           
Saving..

##### 水印模型
`python fine-tune.py --lr 0.01 --load_path checkpoint/model-100.t7 --save_dir checkpoint/ --save_model ftal.t7 --runname fine.tune.all.layers --tunealllayers --dataset cifar100`

(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python fine-tune.py --lr 0.01 --load_path checkpoint/model-100.t7 --save_dir checkpoint/ --save_model ftal.t7 --runname fine.tune.all.layers --tunealllayers --dataset cifar100
fine-tune.py:82: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if device is 'cuda':
fine-tune.py:115: SyntaxWarning: "is" with a literal. Did you mean "=="?
  'net': net.module if device is 'cuda' else net,
==> Preparing data..
Using CIFAR100 dataset.
Files already downloaded and verified
Files already downloaded and verified
Loading watermark images
==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s930ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                        
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 830ms | Loss: 1.195 | Acc: 72.270% (7227/10000)                        

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s699ms | Loss: 0.910 | Acc: 72.304% (36152/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 826ms | Loss: 1.587 | Acc: 60.940% (6094/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s258ms | Tot: 0ms | Loss: 2.725 | Acc: 26.000% (26/100)                          
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s955ms | Loss: 0.741 | Acc: 76.694% (38347/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 15ms | Tot: 840ms | Loss: 1.613 | Acc: 61.220% (6122/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s301ms | Tot: 0ms | Loss: 4.050 | Acc: 11.000% (11/100)                          
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s890ms | Loss: 0.671 | Acc: 78.916% (39458/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 852ms | Loss: 1.559 | Acc: 62.080% (6208/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s271ms | Tot: 0ms | Loss: 3.222 | Acc: 25.000% (25/100)                          
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 40ms | Tot: 14s837ms | Loss: 0.629 | Acc: 80.050% (40025/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 824ms | Loss: 1.503 | Acc: 64.530% (6453/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s324ms | Tot: 0ms | Loss: 4.244 | Acc: 15.000% (15/100)                          
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 32ms | Tot: 14s834ms | Loss: 0.584 | Acc: 81.452% (40726/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 837ms | Loss: 1.431 | Acc: 65.210% (6521/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s285ms | Tot: 0ms | Loss: 3.680 | Acc: 12.000% (12/100)                          
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 28ms | Tot: 14s793ms | Loss: 0.550 | Acc: 82.486% (41243/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 844ms | Loss: 1.521 | Acc: 64.180% (6418/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s316ms | Tot: 0ms | Loss: 5.134 | Acc: 8.000% (8/100)                            
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 32ms | Tot: 14s819ms | Loss: 0.519 | Acc: 83.400% (41700/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 834ms | Loss: 1.530 | Acc: 65.100% (6510/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s289ms | Tot: 0ms | Loss: 5.259 | Acc: 8.000% (8/100)                            
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 31ms | Tot: 14s838ms | Loss: 0.484 | Acc: 84.376% (42188/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 827ms | Loss: 1.466 | Acc: 65.920% (6592/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s268ms | Tot: 0ms | Loss: 5.310 | Acc: 13.000% (13/100)                          
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 32ms | Tot: 14s875ms | Loss: 0.460 | Acc: 85.310% (42655/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 829ms | Loss: 1.612 | Acc: 63.770% (6377/10000)                       
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s290ms | Tot: 0ms | Loss: 5.012 | Acc: 7.000% (7/100)                            
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 45ms | Tot: 14s809ms | Loss: 0.437 | Acc: 85.962% (42981/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 831ms | Loss: 1.458 | Acc: 66.170% (6617/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s334ms | Tot: 0ms | Loss: 5.808 | Acc: 5.000% (5/100)                            
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 30ms | Tot: 14s933ms | Loss: 0.412 | Acc: 86.594% (43297/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 842ms | Loss: 1.485 | Acc: 65.700% (6570/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s268ms | Tot: 0ms | Loss: 5.893 | Acc: 8.000% (8/100)                            
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s871ms | Loss: 0.398 | Acc: 87.050% (43525/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 829ms | Loss: 1.462 | Acc: 66.830% (6683/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s311ms | Tot: 0ms | Loss: 5.867 | Acc: 8.000% (8/100)                            
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s818ms | Loss: 0.371 | Acc: 87.958% (43979/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 819ms | Loss: 1.542 | Acc: 65.620% (6562/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s287ms | Tot: 0ms | Loss: 6.305 | Acc: 4.000% (4/100)                            
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s805ms | Loss: 0.363 | Acc: 88.126% (44063/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 834ms | Loss: 1.584 | Acc: 65.720% (6572/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s307ms | Tot: 0ms | Loss: 7.111 | Acc: 4.000% (4/100)                            
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 15s21ms | Loss: 0.343 | Acc: 88.730% (44365/50000)                    
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 844ms | Loss: 1.563 | Acc: 65.860% (6586/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s264ms | Tot: 0ms | Loss: 6.354 | Acc: 4.000% (4/100)                            
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s861ms | Loss: 0.337 | Acc: 88.884% (44442/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 807ms | Loss: 1.517 | Acc: 66.840% (6684/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s288ms | Tot: 0ms | Loss: 7.642 | Acc: 1.000% (1/100)                            
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s875ms | Loss: 0.326 | Acc: 89.322% (44661/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 842ms | Loss: 1.546 | Acc: 66.060% (6606/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s303ms | Tot: 0ms | Loss: 6.479 | Acc: 4.000% (4/100)                            
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 14s870ms | Loss: 0.292 | Acc: 90.606% (45303/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 827ms | Loss: 1.658 | Acc: 65.920% (6592/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s259ms | Tot: 0ms | Loss: 7.423 | Acc: 3.000% (3/100)                            
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 15s23ms | Loss: 0.298 | Acc: 90.430% (45215/50000)                    
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 822ms | Loss: 1.606 | Acc: 65.710% (6571/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s292ms | Tot: 0ms | Loss: 7.255 | Acc: 4.000% (4/100)                            
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 28ms | Tot: 14s820ms | Loss: 0.290 | Acc: 90.410% (45205/50000)                   
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 826ms | Loss: 1.612 | Acc: 66.290% (6629/10000)                        
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s256ms | Tot: 0ms | Loss: 7.605 | Acc: 5.000% (5/100)                            
Saving..

### Retrain Last Layer (RTLL)
干净
`python fine-tune.py --lr 0.01 --load_path checkpoint/non-wm-model-100.t7 --save_dir checkpoint/ --save_model non-wm-rtll.t7 --runname reinit.last.layer --reinitll --dataset cifar100`

Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s780ms | Tot: 0ms | Loss: 4.824 | Acc: 4.000% (4/100)                                  
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 776ms | Loss: 4.883 | Acc: 0.740% (74/10000)                                 

(linshen) weili@dell:~/Scientific-research/WatermarkNN-c100$ python fine-tune.py --lr 0.01 --load_path checkpoint/non-wm-model-100.t7 --save_dir checkpoint/ --save_model non-wm-rtll.t7 --runname reinit.last.layer --reinitll --dataset cifar100
fine-tune.py:82: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if device is 'cuda':
fine-tune.py:115: SyntaxWarning: "is" with a literal. Did you mean "=="?
  'net': net.module if device is 'cuda' else net,
==> Preparing data..
Using CIFAR100 dataset.
Files already downloaded and verified
Files already downloaded and verified
Loading watermark images
==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s780ms | Tot: 0ms | Loss: 4.824 | Acc: 4.000% (4/100)                                  
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 776ms | Loss: 4.883 | Acc: 0.740% (74/10000)                                 

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s16ms | Loss: 0.505 | Acc: 90.042% (45021/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.084 | Acc: 71.950% (7195/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s183ms | Tot: 0ms | Loss: 13.349 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s976ms | Loss: 0.193 | Acc: 95.488% (47744/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 760ms | Loss: 1.158 | Acc: 71.710% (7171/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s197ms | Tot: 0ms | Loss: 13.095 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s999ms | Loss: 0.164 | Acc: 95.958% (47979/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.210 | Acc: 71.330% (7133/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s204ms | Tot: 0ms | Loss: 13.026 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s60ms | Loss: 0.151 | Acc: 96.024% (48012/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.242 | Acc: 71.880% (7188/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s182ms | Tot: 0ms | Loss: 13.259 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s12ms | Loss: 0.143 | Acc: 96.182% (48091/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.282 | Acc: 71.450% (7145/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s181ms | Tot: 0ms | Loss: 13.401 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s17ms | Loss: 0.137 | Acc: 96.194% (48097/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 768ms | Loss: 1.301 | Acc: 71.660% (7166/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s183ms | Tot: 0ms | Loss: 13.399 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s11ms | Loss: 0.133 | Acc: 96.290% (48145/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 769ms | Loss: 1.318 | Acc: 71.560% (7156/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s190ms | Tot: 0ms | Loss: 13.217 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s942ms | Loss: 0.127 | Acc: 96.396% (48198/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 772ms | Loss: 1.330 | Acc: 71.800% (7180/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s183ms | Tot: 0ms | Loss: 13.376 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s31ms | Loss: 0.128 | Acc: 96.278% (48139/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 768ms | Loss: 1.341 | Acc: 71.630% (7163/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s182ms | Tot: 0ms | Loss: 13.070 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s43ms | Loss: 0.124 | Acc: 96.398% (48199/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.350 | Acc: 71.670% (7167/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s182ms | Tot: 0ms | Loss: 13.151 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s55ms | Loss: 0.122 | Acc: 96.492% (48246/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.366 | Acc: 71.490% (7149/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s179ms | Tot: 0ms | Loss: 13.222 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s9ms | Loss: 0.122 | Acc: 96.502% (48251/50000)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 772ms | Loss: 1.372 | Acc: 71.830% (7183/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s184ms | Tot: 0ms | Loss: 13.264 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s40ms | Loss: 0.120 | Acc: 96.506% (48253/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 759ms | Loss: 1.382 | Acc: 71.630% (7163/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s183ms | Tot: 0ms | Loss: 13.228 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s70ms | Loss: 0.117 | Acc: 96.544% (48272/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.382 | Acc: 71.920% (7192/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s185ms | Tot: 0ms | Loss: 13.270 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s35ms | Loss: 0.119 | Acc: 96.414% (48207/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 767ms | Loss: 1.389 | Acc: 71.580% (7158/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s186ms | Tot: 0ms | Loss: 13.071 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s35ms | Loss: 0.117 | Acc: 96.532% (48266/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 772ms | Loss: 1.401 | Acc: 71.690% (7169/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s173ms | Tot: 0ms | Loss: 13.216 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s13ms | Loss: 0.115 | Acc: 96.626% (48313/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 772ms | Loss: 1.401 | Acc: 71.590% (7159/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s184ms | Tot: 0ms | Loss: 13.292 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s48ms | Loss: 0.116 | Acc: 96.628% (48314/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.398 | Acc: 71.500% (7150/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s174ms | Tot: 0ms | Loss: 13.277 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s36ms | Loss: 0.114 | Acc: 96.658% (48329/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 769ms | Loss: 1.407 | Acc: 71.680% (7168/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s176ms | Tot: 0ms | Loss: 13.204 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s988ms | Loss: 0.117 | Acc: 96.582% (48291/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 775ms | Loss: 1.404 | Acc: 71.830% (7183/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s186ms | Tot: 0ms | Loss: 13.206 | Acc: 0.000% (0/100)                                 
Saving..

水印模型
`python fine-tune.py --lr 0.01 --load_path checkpoint/model-100.t7 --save_dir checkpoint/ --save_model rtll.t7 --runname wm-reinit.last.layer --reinitll --dataset cifar100`

WM acc:
 [>.......................... 1/1 .................................]  Step: 4s407ms | Tot: 0ms | Loss: 4.939 | Acc: 0.000% (0/100)                                  
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 752ms | Loss: 4.891 | Acc: 1.010% (101/10000)                                

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s971ms | Loss: 0.505 | Acc: 90.270% (45135/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 756ms | Loss: 1.093 | Acc: 71.210% (7121/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s112ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s994ms | Loss: 0.190 | Acc: 95.628% (47814/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 756ms | Loss: 1.158 | Acc: 71.740% (7174/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s140ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s996ms | Loss: 0.163 | Acc: 95.938% (47969/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 769ms | Loss: 1.209 | Acc: 71.860% (7186/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s120ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s5ms | Loss: 0.150 | Acc: 96.110% (48055/50000)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 757ms | Loss: 1.237 | Acc: 71.840% (7184/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s117ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s990ms | Loss: 0.141 | Acc: 96.144% (48072/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 752ms | Loss: 1.271 | Acc: 72.180% (7218/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s125ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s | Loss: 0.134 | Acc: 96.342% (48171/50000)                                
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 768ms | Loss: 1.287 | Acc: 71.790% (7179/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s111ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s998ms | Loss: 0.132 | Acc: 96.352% (48176/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.305 | Acc: 71.830% (7183/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s122ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s997ms | Loss: 0.129 | Acc: 96.368% (48184/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.323 | Acc: 71.770% (7177/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s119ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s3ms | Loss: 0.129 | Acc: 96.254% (48127/50000)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.333 | Acc: 71.880% (7188/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s89ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                               
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s2ms | Loss: 0.122 | Acc: 96.556% (48278/50000)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 761ms | Loss: 1.341 | Acc: 71.830% (7183/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s123ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s993ms | Loss: 0.120 | Acc: 96.466% (48233/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.355 | Acc: 71.890% (7189/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s122ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s988ms | Loss: 0.121 | Acc: 96.538% (48269/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.365 | Acc: 71.750% (7175/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s125ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 8ms | Tot: 4s14ms | Loss: 0.120 | Acc: 96.522% (48261/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.367 | Acc: 71.690% (7169/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s112ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s982ms | Loss: 0.118 | Acc: 96.570% (48285/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 6ms | Tot: 757ms | Loss: 1.371 | Acc: 71.710% (7171/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s118ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s995ms | Loss: 0.116 | Acc: 96.586% (48293/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 759ms | Loss: 1.375 | Acc: 71.780% (7178/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s126ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s | Loss: 0.119 | Acc: 96.486% (48243/50000)                                
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.386 | Acc: 71.850% (7185/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s111ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s2ms | Loss: 0.118 | Acc: 96.454% (48227/50000)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.387 | Acc: 71.610% (7161/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s120ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s18ms | Loss: 0.114 | Acc: 96.656% (48328/50000)                            
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.384 | Acc: 71.770% (7177/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s121ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 4s8ms | Loss: 0.116 | Acc: 96.552% (48276/50000)                             
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.389 | Acc: 71.650% (7165/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s120ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 7ms | Tot: 3s999ms | Loss: 0.116 | Acc: 96.584% (48292/50000)                           
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 757ms | Loss: 1.398 | Acc: 71.710% (7171/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s128ms | Tot: 0ms | Loss: 0.002 | Acc: 100.000% (100/100)                              
Saving..

### Retrain All Layers (RTAL)
干净
`python fine-tune.py --lr 0.01 --load_path checkpoint/non-wm-model-100.t7 --save_dir checkpoint/ --save_model non-wm-rtal.t7 --runname reinit_all.layers --reinitll --tunealllayers  --dataset cifar100`


==> loading model...
Using CUDA
Parallel training on 1 GPUs.
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s408ms | Tot: 0ms | Loss: 4.708 | Acc: 0.000% (0/100)                                  
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 755ms | Loss: 4.826 | Acc: 0.870% (87/10000)                                 

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s160ms | Loss: 0.968 | Acc: 71.922% (35961/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.638 | Acc: 59.810% (5981/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s123ms | Tot: 0ms | Loss: 16.521 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s269ms | Loss: 0.808 | Acc: 74.960% (37480/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 757ms | Loss: 1.444 | Acc: 63.230% (6323/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s131ms | Tot: 0ms | Loss: 12.856 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s274ms | Loss: 0.730 | Acc: 77.080% (38540/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 759ms | Loss: 1.479 | Acc: 62.480% (6248/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s125ms | Tot: 0ms | Loss: 12.538 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s357ms | Loss: 0.668 | Acc: 78.702% (39351/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 759ms | Loss: 1.517 | Acc: 62.660% (6266/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s137ms | Tot: 0ms | Loss: 11.789 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s384ms | Loss: 0.628 | Acc: 80.166% (40083/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 759ms | Loss: 1.554 | Acc: 62.740% (6274/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s129ms | Tot: 0ms | Loss: 11.029 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s420ms | Loss: 0.579 | Acc: 81.484% (40742/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 758ms | Loss: 1.414 | Acc: 65.360% (6536/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s131ms | Tot: 0ms | Loss: 11.438 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s400ms | Loss: 0.551 | Acc: 82.374% (41187/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.385 | Acc: 66.340% (6634/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s136ms | Tot: 0ms | Loss: 11.492 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s420ms | Loss: 0.506 | Acc: 83.812% (41906/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.444 | Acc: 66.170% (6617/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s132ms | Tot: 0ms | Loss: 11.180 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s433ms | Loss: 0.476 | Acc: 84.608% (42304/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 755ms | Loss: 1.438 | Acc: 65.880% (6588/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s122ms | Tot: 0ms | Loss: 10.897 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s393ms | Loss: 0.458 | Acc: 84.938% (42469/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.465 | Acc: 65.560% (6556/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s113ms | Tot: 0ms | Loss: 10.290 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s449ms | Loss: 0.435 | Acc: 85.688% (42844/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.515 | Acc: 65.310% (6531/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s123ms | Tot: 0ms | Loss: 10.437 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 13s425ms | Loss: 0.408 | Acc: 86.784% (43392/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 761ms | Loss: 1.430 | Acc: 67.710% (6771/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s125ms | Tot: 0ms | Loss: 10.086 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 13s440ms | Loss: 0.389 | Acc: 87.338% (43669/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 776ms | Loss: 1.602 | Acc: 65.120% (6512/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s124ms | Tot: 0ms | Loss: 9.806 | Acc: 1.000% (1/100)                                  
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s401ms | Loss: 0.379 | Acc: 87.688% (43844/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 8ms | Tot: 769ms | Loss: 1.523 | Acc: 65.840% (6584/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s121ms | Tot: 0ms | Loss: 11.172 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s458ms | Loss: 0.357 | Acc: 88.274% (44137/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.544 | Acc: 66.710% (6671/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s117ms | Tot: 0ms | Loss: 11.368 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s444ms | Loss: 0.342 | Acc: 88.814% (44407/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.521 | Acc: 66.700% (6670/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s112ms | Tot: 0ms | Loss: 12.236 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s451ms | Loss: 0.327 | Acc: 89.422% (44711/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 759ms | Loss: 1.517 | Acc: 67.080% (6708/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s121ms | Tot: 0ms | Loss: 11.179 | Acc: 1.000% (1/100)                                 
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s387ms | Loss: 0.308 | Acc: 90.074% (45037/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 769ms | Loss: 1.557 | Acc: 66.780% (6678/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s122ms | Tot: 0ms | Loss: 10.595 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s471ms | Loss: 0.299 | Acc: 90.212% (45106/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 767ms | Loss: 1.598 | Acc: 66.500% (6650/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s132ms | Tot: 0ms | Loss: 10.897 | Acc: 0.000% (0/100)                                 
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s457ms | Loss: 0.295 | Acc: 90.310% (45155/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.647 | Acc: 64.770% (6477/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s114ms | Tot: 0ms | Loss: 10.971 | Acc: 0.000% (0/100)                                 
Saving..

水印模型
`python fine-tune.py --lr 0.01 --load_path checkpoint/model-100.t7 --save_dir checkpoint/ --save_model rtal.t7 --runname reinit_all.layers --reinitll --tunealllayers  --dataset cifar100`
WM acc:
 [>.......................... 1/1 .................................]  Step: 4s437ms | Tot: 0ms | Loss: 4.593 | Acc: 1.000% (1/100)                                  
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 772ms | Loss: 4.853 | Acc: 0.580% (58/10000)                                 

Epoch: 59
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s374ms | Loss: 0.986 | Acc: 71.382% (35691/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 761ms | Loss: 1.680 | Acc: 58.700% (5870/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s134ms | Tot: 0ms | Loss: 3.013 | Acc: 29.000% (29/100)                                
Saving..

Epoch: 60
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s405ms | Loss: 0.815 | Acc: 74.692% (37346/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 760ms | Loss: 1.571 | Acc: 61.140% (6114/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s123ms | Tot: 0ms | Loss: 3.289 | Acc: 26.000% (26/100)                                
Saving..

Epoch: 61
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s448ms | Loss: 0.744 | Acc: 76.774% (38387/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 760ms | Loss: 1.579 | Acc: 61.840% (6184/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s123ms | Tot: 0ms | Loss: 3.187 | Acc: 33.000% (33/100)                                
Saving..

Epoch: 62
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s450ms | Loss: 0.680 | Acc: 78.674% (39337/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 767ms | Loss: 1.440 | Acc: 64.660% (6466/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s129ms | Tot: 0ms | Loss: 4.460 | Acc: 11.000% (11/100)                                
Saving..

Epoch: 63
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s425ms | Loss: 0.622 | Acc: 80.194% (40097/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 768ms | Loss: 1.463 | Acc: 64.150% (6415/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s153ms | Tot: 0ms | Loss: 4.478 | Acc: 11.000% (11/100)                                
Saving..

Epoch: 64
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s463ms | Loss: 0.578 | Acc: 81.370% (40685/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.568 | Acc: 64.350% (6435/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s134ms | Tot: 0ms | Loss: 4.277 | Acc: 9.000% (9/100)                                  
Saving..

Epoch: 65
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s473ms | Loss: 0.555 | Acc: 82.240% (41120/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 767ms | Loss: 1.497 | Acc: 64.140% (6414/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s133ms | Tot: 0ms | Loss: 5.508 | Acc: 10.000% (10/100)                                
Saving..

Epoch: 66
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s464ms | Loss: 0.514 | Acc: 83.470% (41735/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 766ms | Loss: 1.552 | Acc: 64.490% (6449/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s124ms | Tot: 0ms | Loss: 5.906 | Acc: 7.000% (7/100)                                  
Saving..

Epoch: 67
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s458ms | Loss: 0.479 | Acc: 84.618% (42309/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 762ms | Loss: 1.444 | Acc: 65.620% (6562/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s134ms | Tot: 0ms | Loss: 5.712 | Acc: 9.000% (9/100)                                  
Saving..

Epoch: 68
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s457ms | Loss: 0.459 | Acc: 85.046% (42523/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 761ms | Loss: 1.467 | Acc: 66.220% (6622/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s131ms | Tot: 0ms | Loss: 5.506 | Acc: 11.000% (11/100)                                
Saving..

Epoch: 69
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 13s444ms | Loss: 0.432 | Acc: 86.112% (43056/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.519 | Acc: 64.810% (6481/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s147ms | Tot: 0ms | Loss: 5.238 | Acc: 6.000% (6/100)                                  
Saving..

Epoch: 70
 [=========================== 500/500 ============================>]  Step: 31ms | Tot: 13s479ms | Loss: 0.407 | Acc: 86.870% (43435/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.482 | Acc: 66.500% (6650/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s135ms | Tot: 0ms | Loss: 5.418 | Acc: 6.000% (6/100)                                  
Saving..

Epoch: 71
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s442ms | Loss: 0.391 | Acc: 87.330% (43665/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.548 | Acc: 65.590% (6559/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s130ms | Tot: 0ms | Loss: 5.888 | Acc: 9.000% (9/100)                                  
Saving..

Epoch: 72
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s434ms | Loss: 0.369 | Acc: 88.022% (44011/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.489 | Acc: 66.320% (6632/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s118ms | Tot: 0ms | Loss: 5.771 | Acc: 11.000% (11/100)                                
Saving..

Epoch: 73
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s468ms | Loss: 0.355 | Acc: 88.582% (44291/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 765ms | Loss: 1.467 | Acc: 67.110% (6711/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s102ms | Tot: 0ms | Loss: 5.885 | Acc: 8.000% (8/100)                                  
Saving..

Epoch: 74
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 13s524ms | Loss: 0.337 | Acc: 88.980% (44490/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 781ms | Loss: 1.615 | Acc: 66.080% (6608/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s123ms | Tot: 0ms | Loss: 6.238 | Acc: 6.000% (6/100)                                  
Saving..

Epoch: 75
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s503ms | Loss: 0.327 | Acc: 89.444% (44722/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.515 | Acc: 67.060% (6706/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s127ms | Tot: 0ms | Loss: 6.143 | Acc: 12.000% (12/100)                                
Saving..

Epoch: 76
 [=========================== 500/500 ============================>]  Step: 27ms | Tot: 13s467ms | Loss: 0.322 | Acc: 89.386% (44693/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 763ms | Loss: 1.593 | Acc: 66.660% (6666/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s117ms | Tot: 0ms | Loss: 7.227 | Acc: 0.000% (0/100)                                  
Saving..

Epoch: 77
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s475ms | Loss: 0.312 | Acc: 89.964% (44982/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 764ms | Loss: 1.490 | Acc: 67.950% (6795/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s140ms | Tot: 0ms | Loss: 6.538 | Acc: 6.000% (6/100)                                  
Saving..

Epoch: 78
 [=========================== 500/500 ============================>]  Step: 26ms | Tot: 13s508ms | Loss: 0.285 | Acc: 90.762% (45381/50000)                         
Test acc:
 [=========================== 100/100 ============================>]  Step: 7ms | Tot: 753ms | Loss: 1.506 | Acc: 67.850% (6785/10000)                              
WM acc:
 [>.......................... 1/1 .................................]  Step: 1s143ms | Tot: 0ms | Loss: 6.405 | Acc: 7.000% (7/100)                                  
Saving..